# BUCT 数据挖掘项目

北京化工大学数据挖掘课程作业 - 实现 Apriori 算法和 FP-Tree (FP-Growth) 算法

## 项目简介

本项目实现了两种经典的频繁项集挖掘算法：
- **Apriori 算法**：基于候选生成-测试的频繁项集挖掘算法
- **FP-Tree (FP-Growth) 算法**：基于频繁模式树的频繁项集挖掘算法

项目支持多线程并发处理，可以对比两种算法的性能表现。

## 功能特性

- ✅ 实现 Apriori 算法，支持多线程并发处理
- ✅ 实现 FP-Tree (FP-Growth) 算法
- ✅ 支持从 CSV 文件加载数据
- ✅ 使用倒排索引优化数据访问
- ✅ 多线程并发数据加载和转换
- ✅ 性能统计和对比
- ✅ 支持自定义置信度/最小支持度
- ✅ 支持自定义并发线程数

## 项目结构

```
buct_DMining/
├── CMakeLists.txt          # CMake 构建配置
├── src/                    # 源代码目录
│   ├── main.cpp           # 主程序入口
│   ├── apriori/           # Apriori 算法实现
│   │   ├── apr.hpp
│   │   └── apr.cpp
│   ├── fptree/            # FP-Tree 算法实现
│   │   ├── fp.hpp
│   │   └── fp.cpp
│   └── dataload/          # 数据加载模块
│       ├── data_loader.hpp
│       └── data_loader.cpp
├── include/                # 头文件目录
│   ├── internal/          # CSV 解析库内部实现
│   └── external/          # 外部依赖头文件
├── retail.csv             # 示例数据文件
└── README.md              # 项目说明文档
```

## 依赖要求

- **C++17** 或更高版本
- **CMake 3.10** 或更高版本
- **支持 C++17 的编译器**（如 GCC 7+, Clang 5+, MSVC 2017+）
- **多线程支持**（C++11 std::thread）

## 构建方法

### 1. 使用 CMake 构建（推荐）

```bash
# 创建构建目录
mkdir build
cd build

# 配置项目
cmake ..

# 编译
make

# 或者使用 cmake --build
cmake --build .
```

### 2. 使用 Makefile 构建

```bash
make
```

编译完成后，可执行文件位于 `build/dig` 或项目根目录的 `dig`。

## 使用方法

### 运行程序

```bash
./build/dig
# 或
./dig
```

### 交互式输入

程序运行后会提示输入以下参数：

1. **并发数量**：用于数据加载和 Apriori 算法的线程数
   - 建议值：CPU 核心数或略大于核心数
   - 示例：`4`、`8`

2. **置信度/最小支持度**：频繁项集的最小支持度阈值
   - 范围：0.0 - 1.0（相对支持度）或大于 0 的整数（绝对支持度）
   - 示例：`0.01`（1%）、`100`（100条记录）

3. **算法选择**：
   - `1` - 使用 Apriori 算法
   - `2` - 使用 FP-Tree 算法

### 使用示例

```
========== 算法性能测试 ==========
请输入并发数量: 4
请输入置信度: 0.01
检验哪种算法： 1.Apriori 2.FPTree 1

数据加载和转换完成！
  - 记录总数: 88162
  - 最大元素值: 16470
  - 耗时: 123 ms

使用置信度: 0.01

========== 性能统计 ==========
数据加载和转换时间: 123 ms
Apriori 算法时间: 456 ms
total time: 579 ms
================================
```

## 数据格式

程序支持从 CSV 文件加载数据，默认使用空格作为分隔符。

**数据格式要求**：
- 每行代表一条事务记录
- 每行的元素用空格分隔
- 元素值为整数

**示例数据**（`retail.csv`）：
```
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29
30 31 32
33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62
...
```

## 算法说明

### Apriori 算法

Apriori 算法是一种基于候选生成-测试的频繁项集挖掘算法。算法通过逐层搜索的方式，从频繁 1-项集开始，逐步生成更大的候选频繁项集，并通过扫描数据库来验证其支持度。

**特点**：
- 需要多次扫描数据库
- 支持多线程并发处理
- 适合中小规模数据集

### FP-Tree (FP-Growth) 算法

FP-Growth 算法是一种基于频繁模式树的频繁项集挖掘算法。算法首先构建 FP-Tree，然后通过递归挖掘条件模式基来发现频繁项集，避免了生成大量候选集。

**特点**：
- 只需要两次扫描数据库
- 使用树结构压缩数据
- 通常比 Apriori 算法更快

## 性能优化

- **倒排索引**：使用倒排索引加速数据访问
- **多线程并发**：支持多线程并发处理数据加载和算法执行
- **内存优化**：使用高效的数据结构减少内存占用

## 注意事项

1. 数据文件路径：确保 `retail.csv` 文件位于程序运行目录，或修改代码中的文件路径
2. 内存使用：大规模数据集可能需要较多内存
3. 线程数设置：建议设置为 CPU 核心数，过多线程可能导致性能下降

## 许可证

本项目为课程作业项目，仅供学习使用。

## 作者

北京化工大学数据挖掘课程作业

---

如有问题或建议，欢迎提出 Issue 或 Pull Request。
